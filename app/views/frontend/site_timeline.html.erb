<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">

<style>
.tooltip {
  position: relative;
  display: inline-block;
}

.tooltip .tooltiptext {
  visibility: hidden;
  width: 80px;
  background-color: #E2E5DE;
  color: black;
  text-align: center;
  border-radius: 6px;
  padding: 5px 0;
  position: absolute;
  z-index: 1;
  top: 100%;
  left: 50%;
  margin-left: -60px;
}

.tooltip:hover .tooltiptext {
  visibility: visible;
}

.Timeline {
  display: flex;
  align-items: center;
}

body{
  background-color: #678983;
}

.top-pad{
  padding-top: 15px;
}

.top-container{
  background-color: #fff;
  overflow: scroll;
  overflow-x: hidden;
  height:75vh;
  border-radius: 7px;
  box-shadow:
    1.1px 1.1px 19.3px rgba(0, 0, 0, 0.12),
  2.7px 2.7px 23.2px rgba(0, 0, 0, 0.095),
  5px 5px 25.2px rgba(0, 0, 0, 0.077),
  8.9px 8.9px 28.5px rgba(0, 0, 0, 0.065),
  16.7px 16.7px 36.3px rgba(0, 0, 0, 0.053),
  40px 40px 57px rgba(0, 0, 0, 0.036);
}

.bottom-container{
  background-color:#fff;
  height: 17vh;
  border-radius : 7px;
box-shadow:
  1.1px 1.1px 19.3px rgba(0, 0, 0, 0.12),
2.7px 2.7px 23.2px rgba(0, 0, 0, 0.095),
5px 5px 25.2px rgba(0, 0, 0, 0.077),
8.9px 8.9px 28.5px rgba(0, 0, 0, 0.065),
16.7px 16.7px 36.3px rgba(0, 0, 0, 0.053),
40px 40px 57px rgba(0, 0, 0, 0.036);
}

#piechart{
  transform: scale(0.8);
}

</style>


<% url = (params[:site_timeline].present? and params[:site_timeline][:url].present?) ? params[:site_timeline][:url] : nil %>
<%start_date = (params[:site_timeline].present? and params[:site_timeline][:start_date].present?) ? 
  params[:site_timeline][:start_date] : V2::Test.first.created_at%>
<%end_date = (params[:site_timeline].present? and params[:site_timeline][:end_date].present?) ? 
  params[:site_timeline][:end_date] : V2::Test.last.updated_at%>


<div class="w3-row" style="padding-top : 30px">
  <div class="w3-col s2">.</div>
  <% if url.present? %>
    <%if start_date <= end_date  %>
      <div class="w3-col s8 top-container">
        <h3 class="w3-center" style="font-family: 'Roboto', sans-serif;"> <%=start_date.to_date %>  to  <%=end_date.to_date %> </h3>
      <div style="padding-top : 20px; transform : scale(0.8)">
        <% data =  V2::Website.where(:url => params[:site_timeline][:url]).first.timeline_for_plugins(start_date, end_date.to_date + 1.day) %>
        <h1 style="padding-right : 150px"> Plugins </h1>
        <% data.each do |key, value| %>
          <ul><h2 style="margin-top : 30px"> <%= "#{key}" %> </h2></ul>
          <div class="Timeline">
            <% test = 1%>
            <% size = 1000 / (value.count*value.count) %>
            <% value.each do |status| %>

              <svg height="3" width=<%= size%>>
                <line x1="0" y1="0" x2="200" y2="0" style="stroke:#004165;stroke-width:5" />
              </svg>

              <% if status == true  %>
                <div class="tooltip">
                  <svg height="20" width="20">
                    <circle cx="10" cy="11" r="5" fill="#228B22" />
                  </svg>
                  <span class="tooltiptext">Test  <%= test%></span>
                </div>
              <% else %>
                <div class="tooltip">
                  <svg height="20" width="20">
                    <circle cx="10" cy="11" r="5" fill="#FF0000" />
                  </svg>
                  <span class="tooltiptext">Test <%= test%></span>
                </div>
              <% end %>

              <% test += 1 %>
            <% end %>

            <svg height="3" width="20">
              <line x1="0" y1="0" x2="200" y2="0" style="stroke:#004165;stroke-width:5" />
            </svg>
          </div>
        <% end %>

        <%= data =  V2::Website.where(:url => params[:site_timeline][:url]).first.timeline_for_themes(start_date, end_date.to_date + 1.day) %>
        <h1 style="padding-right : 150px"> Themes </h1>
          <ul><h2 style="margin-top : 30px"> <%= "#{key}" %> </h2></ul>
          <div class="Timeline">
            <% test = 1%>
            <% size = 800 / (value.count*value.count) %>
            <% value.each do |status| %>

              <svg height="3" width=<%= size%>>
                <line x1="0" y1="0" x2="200" y2="0" style="stroke:#004165;stroke-width:5" />
              </svg>

              <% if status == true  %>
                <div class="tooltip">
                  <svg height="20" width="20">
                    <circle cx="10" cy="11" r="5" fill="#228B22" />
                  </svg>
                  <span class="tooltiptext">Test  <%= test%></span>
                </div>
              <% else %>
                <div class="tooltip">
                  <svg height="20" width="20">
                    <circle cx="10" cy="11" r="5" fill="#FF0000" />
                  </svg>
                  <span class="tooltiptext">Test <%= test%></span>
                </div>
              <% end %>
              <% test += 1 %>
            <% end %>

            <svg height="3" width="20">
              <line x1="0" y1="0" x2="200" y2="0" style="stroke:#004165;stroke-width:5" />
            </svg>
          </div>
        <% end %>

        <% data =  V2::Website.where(:url => url).first.timeline_for_js(start_date, end_date) %>
        <h1 style="padding-top : 100px"> Js </h1>
>>>>>>> 37784f39ccc5efdea9afd3409a3669b009d40ec7
        <% data.each do |key, value| %>
          <ul><h2 style="margin-top : 30px"> <%= "#{key}" %> </h2></ul>
          <div class="Timeline">
            <% test = 1%>
            <% size = 800 / (value.count*value.count) %>
            <% value.each do |status| %>

              <svg height="3" width=<%= size%>>
                <line x1="0" y1="0" x2="200" y2="0" style="stroke:#004165;stroke-width:5" />
              </svg>

              <% if status == true  %>
                <div class="tooltip">
                  <svg height="20" width="20">
                    <circle cx="10" cy="11" r="5" fill="#228B22" />
                  </svg>
                  <span class="tooltiptext">Test  <%= test%></span>
                </div>
              <% else %>
                <div class="tooltip">
                  <svg height="20" width="20">
                    <circle cx="10" cy="11" r="5" fill="#FF0000" />
                  </svg>
                  <span class="tooltiptext">Test <%= test%></span>
                </div>
              <% end %>
              <% test += 1 %>
            <% end %>

            <svg height="3" width="20">
              <line x1="0" y1="0" x2="200" y2="0" style="stroke:#004165;stroke-width:5" />
            </svg>
          </div>
        <% end %>


      </div>
      </div>
</div>
<div class="w3-col s2">.</div>
<% end %>
<% end %>

<div class="w3-row top-pad">
  <div class="w3-col s2">.</div>
  <div class="w3-col s8 bottom-container">
    <%= form_for :site_timeline, builder: ActiveAdmin::FormBuilder,
      :url => frontend_site_timeline_path, :method => :post  do |f| %>
      <div class="w3-row w3-center" style="padding-top:30px;font-size:1.5rem">
        <div class="w3-col">
          Select Dates
        </div>
      </div>
      <div class="w3-row w3-center top-pad">
        <div class="w3-col s4">
          <%= f.input :url, :as => :searchable_select, :collection => V2::Website.where(:cms.in => V2::Website::cms).all.pluck(:url), include_blank: true %>
        </div>
        <div class="w3-col s4">
          From : <%= f.text_field :start_date, :class => "datepicker", :placeholder => "start date", 
            :value => (params[:site_timeline].present? and start_date.present?) ? start_date : nil %>
          <% if notice %>
            <p><%= notice%></p>
          <%end%>
        </div>
        <div class="w3-col s4">
          To: <%= f.text_field :end_date, :class => "datepicker", :placeholder => "end date", 
            :value => (params[:site_timeline].present? and end_date.present?) ? end_date : nil %>
        </div>
        <div class="w3-col s4" style="padding-top : 10px">
          <button type="submit" class="w3-button w3-teal">Submit</button>
        </div>
      </div>
    <%end%>

  </div>
  <div class="w3-col s2">.</div>
</div>
